metadata:
  id: "CKV2_CS_AZ_005"
  name: "Ensure storage accounts use customer-managed keys for encryption (CIS 3.3)"
  category: "ENCRYPTION"
  severity: "MEDIUM"
  guideline: "https://docs.microsoft.com/en-us/azure/storage/common/customer-managed-keys-overview"

definition:
  cond_type: "attribute"
  resource_types:
    - "azurerm_storage_account_customer_managed_key"
  attribute: "key_vault_key_id"
  operator: "exists"